<div class="universal-search-container">
  <div class="search-input-wrapper">
    <i class="bi bi-search search-icon"></i>
    <input
      #searchInput
      type="text"
      class="form-control search-input"
      placeholder="Search subscriptions, customers..."
      [(ngModel)]="searchQuery"
      (input)="onSearchChange()"
      (focus)="searchQuery.length >= 3 && searchResults.length > 0 ? showResults = true : null"
    />
    <div *ngIf="isLoading" class="spinner-border spinner-border-sm ms-2" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
  
  <div *ngIf="showResults && searchResults.length > 0" class="search-results-dropdown">
    <button class="close-search-btn" (click)="closeSearch()" type="button" aria-label="Close search">
      <i class="bi bi-x-lg"></i>
    </button>
    <div
      *ngFor="let result of searchResults"
      class="search-result-item"
      (click)="onResultClick(result)"
    >
      <div class="result-icon">
        <i [class]="'bi ' + getResultIcon(result.type)"></i>
      </div>
      <div class="result-content">
        <div class="result-title">{{ result.title }}</div>
        <div class="result-subtitle">{{ result.subtitle }}</div>
        <div class="result-type-badge">{{ result.type }}</div>
      </div>
    </div>
    <div *ngIf="searchResults.length === 0 && !isLoading" class="no-results">
      No results found
    </div>
  </div>
</div>

